using Tensor;
using NUnit.Framework;
using NeuralNetwork;

namespace NeuralNetwork_iTests
{
    [TestFixture]
    public class TensorflowComparisonTests
    {
        [Test]
        public void NeuralNetwork_AveragePooling1DInput5PoolWidth2Stride2PaddingSame_returnsSameResultAsTensorflow()
        {
            int batchSize = 32;
            int[] inputShape = { batchSize, 5, 1 };
            var input = new Tensor<double>(new double[] {-0.88948492,  0.92661850, -0.78068752, -1.05302809,  0.54875880,
                                                         -0.43058864,  0.57726260,  2.18103054,  0.68330074,  0.11384662,
                                                         -1.51834655,  0.39338661, -0.73989191,  0.59889572,  1.39420373,
                                                          1.62761302,  0.31247087, -0.62950797, -0.62453136,  0.70831918,
                                                          1.12416792, -0.71263546, -0.69947717,  0.38295282, -1.01584576,
                                                         -1.00081803, -0.07344025,  1.26782764,  0.78885268, -0.94645885,
                                                          0.68989803, -1.08600283, -2.36134783,  0.68985695,  1.39412940,
                                                         -0.90986848, -2.60152147, -0.39291814, -0.17077930, -2.22401981,
                                                         -0.30930043, -0.17314914, -0.41804612,  0.44706621, -0.80066369,
                                                          0.78764738,  0.01957331,  0.84275454,  0.30134943,  1.03551322,
                                                          0.97813151, -1.79995474, -0.09211400, -0.08195359,  0.22647762,
                                                          0.81142590,  1.20532175, -0.39779814,  0.06571645,  1.83055987,
                                                          0.08936274,  0.72261536,  0.43291354, -1.11608835, -0.36019820,
                                                          1.38884772, -0.27966993,  1.85820337, -0.05518390,  0.19181139,
                                                         -0.18049204,  0.43085942, -0.34160195,  0.64604048,  1.17832201,
                                                         -0.57175789,  0.05269491,  0.57283861, -1.32689755,  1.88217764,
                                                         -1.88413671, -1.52750881, -0.87345869,  0.55348781, -0.54200823,
                                                         -0.16369699, -1.41185854,  0.18460829, -1.48284019, -1.44347558,
                                                          0.84387357, -1.16098603, -2.59353645,  0.16025817,  1.23915112,
                                                         -1.03396588, -0.88411012,  0.62687378,  1.13582557,  0.67557029,
                                                         -1.08890488, -0.86516626,  1.51503736, -0.02638403,  0.61536096,
                                                         -1.41139317, -0.70535512,  0.38755078, -0.37301142,  0.67055805,
                                                         -0.38507912,  0.48903896, -1.59901989, -0.07800988,  0.28456811,
                                                         -0.24594061,  0.94872227, -0.05677852, -1.74661694, -1.51515973,
                                                         -0.23040294,  0.43392762, -0.10212812, -0.16104189,  0.29787965,
                                                          1.51279794,  2.19060681, -0.33010425, -1.44290882, -0.90713671,
                                                          0.04828433, -0.10155463, -0.14713118,  1.39278802, -1.68560085,
                                                          0.51779565,  1.26344855,  0.57317844, -1.34103686,  0.18302390,
                                                         -0.11302457,  0.54865036, -0.28687714,  1.17220688, -0.53739737,
                                                         -0.11887610,  0.87942097, -0.86140980,  0.54538832,  1.12642450,
                                                          0.35264062,  1.46683544,  1.22899533,  1.70194495, -0.29976239,
                                                          1.30328293,  0.65422441, -1.41425686,  0.04768148,  0.6885071 });
            input = input.reshape(inputShape);
            var expected = new Tensor<double>(new double[] { 0.01856679, -0.91685784,  0.54875880,  0.07333697,  1.4321656 ,
                                                             0.11384662, -0.56248000, -0.07049808,  1.39420380,  0.97004200,
                                                            -0.62701964,  0.70831920,  0.20576623, -0.15826220, -1.01584580,
                                                            -0.53712910,  1.02834010, -0.94645890, -0.19805240, -0.83574545,
                                                             1.39412940, -1.75569500, -0.28184873, -2.22401980, -0.24122478,
                                                             0.01451005, -0.80066370,  0.40361035,  0.57205200,  1.03551320,
                                                            -0.41091162, -0.08703379,  0.22647762,  1.00837390, -0.16604085,
                                                             1.83055980,  0.40598905, -0.34158742, -0.36019820,  0.55458890,
                                                             0.90150976,  0.19181138,  0.12518369,  0.15221928,  1.17832200,
                                                            -0.25953150, -0.37702945,  1.88217760, -1.70582270, -0.15998542,
                                                            -0.54200820, -0.78777780, -0.64911590, -1.44347560, -0.15855625,
                                                            -1.21663900,  1.23915110, -0.95903796,  0.88134970,  0.67557030,
                                                            -0.97703550,  0.74432670,  0.61536100, -1.05837420,  0.00726968,
                                                             0.67055804,  0.05197993, -0.83851486,  0.28456810,  0.35139080,
                                                            -0.90169775, -1.51515970,  0.10176234, -0.13158500,  0.29787964,
                                                             1.85170250, -0.88650650, -0.90713674, -0.02663515,  0.62282840,
                                                            -1.68560090,  0.89062214, -0.38392925,  0.18302390,  0.21781291,
                                                             0.44266486, -0.53739740,  0.38027245, -0.15801072,  1.12642460,
                                                             0.90973806,  1.46547010, -0.29976240,  0.97875370, -0.68328770,
                                                             0.68850710});
            expected = expected.reshape(32, 3, 1);

            var networkBuilder = new AveragePooling1D_Input5_PoolWidth2_Stride2_PaddingSame();
            var network = networkBuilder.NeuralNetwork;
            var result = network.predict(input);

            Assert.That(result, Is.EqualTo(expected));
        }

        [Test]
        public void NeuralNetwork_Dense3layers_returnsSameResultAsTensorflow()
        {
            int batchSize = 15;
            int[] inputShape = { batchSize, 64 };
            var input = new Tensor<double>(new double[] { 0.0,  0.0,  5.0, 16.0, 10.0,  0.0,  0.0,  0.0,  0.0,  0.0,  8.0, 16.0, 16.0,
                                                          5.0,  0.0,  0.0,  0.0,  0.0, 14.0, 14.0,  1.0, 12.0,  0.0,  0.0,  0.0,  0.0,
                                                         15.0, 10.0,  0.0,  7.0,  4.0,  0.0,  0.0,  2.0, 16.0,  7.0,  0.0,  2.0,  9.0,
                                                          0.0,  0.0,  2.0, 16.0,  8.0,  0.0,  6.0, 11.0,  0.0,  0.0,  1.0, 12.0, 14.0,
                                                         14.0, 16.0,  5.0,  0.0,  0.0,  0.0,  4.0, 15.0, 16.0,  8.0,  1.0,  0.0,  0.0,
                                                          0.0,  9.0, 14.0, 14.0,  3.0,  0.0,  0.0,  0.0,  4.0, 13.0,  1.0,  4.0, 11.0,
                                                          0.0,  0.0,  0.0,  1.0, 14.0,  1.0, 11.0,  7.0,  6.0,  0.0,  0.0,  0.0, 15.0,
                                                         13.0,  9.0, 12.0,  3.0,  0.0,  0.0,  0.0,  1.0, 14.0, 14.0,  0.0,  0.0,  0.0,
                                                          0.0,  0.0,  5.0, 14.0, 12.0,  0.0,  0.0,  0.0,  0.0,  0.0, 12.0,  1.0,  9.0,
                                                          5.0,  0.0,  0.0,  0.0,  0.0, 11.0, 12.0, 13.0,  3.0,  0.0,  0.0,  0.0,  1.0,
                                                         15.0, 14.0,  2.0,  0.0,  0.0,  0.0,  0.0,  6.0, 14.0,  0.0,  0.0,  3.0,  2.0,
                                                          0.0,  0.0,  2.0, 16.0,  3.0,  2.0, 13.0,  3.0,  0.0,  0.0,  0.0, 11.0, 14.0,
                                                         15.0,  9.0,  0.0,  0.0,  0.0,  0.0,  7.0, 16.0, 11.0,  0.0,  0.0,  0.0,  0.0,
                                                          0.0, 15.0, 13.0, 14.0,  0.0,  0.0,  0.0,  0.0,  2.0, 15.0,  4.0, 16.0,  3.0,
                                                          0.0,  0.0,  0.0,  1.0, 15.0, 16.0, 12.0,  1.0,  0.0,  0.0,  0.0,  1.0, 12.0,
                                                         16.0, 13.0,  2.0,  0.0,  0.0,  0.0,  5.0, 14.0,  6.0, 13.0, 12.0,  0.0,  0.0,
                                                          0.0,  0.0,  0.0,  3.0, 15.0,  7.0,  0.0,  0.0,  0.0,  0.0,  2.0, 16.0,  8.0,
                                                          0.0,  0.0,  0.0,  0.0,  0.0,  1.0, 12.0, 16.0, 11.0,  1.0,  0.0,  0.0,  0.0,
                                                          0.0,  0.0,  5.0, 15.0,  7.0,  0.0,  0.0,  0.0,  6.0,  0.0,  4.0, 14.0,  7.0,
                                                          0.0,  0.0,  0.0, 16.0, 16.0, 15.0,  8.0,  1.0,  0.0,  0.0,  0.0,  0.0, 11.0,
                                                         12.0,  1.0,  0.0,  0.0,  0.0,  0.0,  8.0, 16.0,  9.0,  4.0,  0.0,  0.0,  0.0,
                                                          0.0,  3.0,  4.0,  0.0,  0.0,  0.0,  0.0,  0.0,  1.0,  0.0,  2.0,  8.0,  2.0,
                                                          0.0,  0.0,  0.0,  5.0, 16.0, 16.0, 16.0, 14.0,  2.0,  0.0,  0.0,  2.0, 16.0,
                                                          9.0,  3.0, 13.0,  7.0,  0.0,  0.0,  0.0, 11.0, 14.0,  7.0, 16.0,  9.0,  0.0,
                                                          0.0,  0.0,  1.0, 10.0, 14.0, 10.0,  2.0,  0.0,  0.0,  0.0,  0.0,  3.0, 14.0,
                                                         13.0,  3.0,  0.0,  0.0,  0.0,  0.0, 12.0,  9.0,  8.0,  8.0,  0.0,  0.0,  0.0,
                                                          0.0, 12.0,  8.0, 11.0,  6.0,  0.0,  0.0,  0.0,  0.0,  7.0, 14.0, 11.0,  1.0,
                                                          0.0,  0.0,  1.0,  8.0, 12.0, 15.0,  5.0,  0.0,  0.0,  0.0,  6.0, 14.0,  0.0,
                                                          4.0, 12.0,  0.0,  0.0,  0.0,  0.0,  7.0, 12.0,  1.0, 15.0,  2.0,  0.0,  0.0,
                                                          0.0,  0.0,  3.0, 13.0, 15.0,  2.0,  0.0,  0.0,  0.0,  0.0,  7.0, 15.0,  1.0,
                                                          0.0,  0.0,  0.0,  0.0,  0.0, 15.0, 16.0,  1.0,  0.0,  0.0,  0.0,  0.0,  9.0,
                                                         16.0, 16.0,  2.0,  0.0,  0.0,  0.0,  2.0, 16.0, 16.0, 16.0,  0.0,  0.0,  0.0,
                                                          0.0, 10.0, 16.0, 16.0, 16.0, 16.0,  8.0,  0.0,  0.0,  8.0, 15.0, 15.0, 14.0,
                                                          8.0,  5.0,  0.0,  0.0,  0.0,  0.0, 11.0, 12.0,  0.0,  0.0,  0.0,  0.0,  0.0,
                                                          0.0,  6.0, 15.0,  1.0,  0.0,  0.0,  0.0,  0.0,  1.0,  9.0, 16.0,  6.0,  0.0,
                                                          0.0,  0.0,  4.0, 14.0, 10.0, 11.0, 10.0,  0.0,  0.0,  0.0, 12.0, 10.0,  0.0,
                                                         13.0,  6.0,  0.0,  0.0,  0.0,  6.0,  7.0,  4.0, 16.0,  5.0,  0.0,  0.0,  0.0,
                                                          0.0,  0.0,  0.0,  7.0, 12.0,  1.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  8.0,
                                                         10.0,  0.0,  0.0,  0.0,  8.0, 13.0,  3.0,  0.0, 14.0,  3.0,  0.0,  0.0,  0.0,
                                                          8.0, 16.0, 16.0, 13.0,  3.0,  0.0,  0.0, 12.0, 12.0, 14.0, 15.0,  1.0,  0.0,
                                                          0.0,  1.0, 15.0, 11.0,  6.0,  5.0,  0.0,  0.0,  0.0,  6.0, 15.0, 12.0,  4.0,
                                                          0.0,  0.0,  0.0,  0.0,  6.0, 11.0,  8.0, 13.0,  6.0,  0.0,  0.0,  0.0,  0.0,
                                                          0.0,  0.0,  1.0, 13.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  9.0,  3.0,
                                                          0.0,  0.0,  2.0,  6.0,  1.0,  6.0, 14.0,  3.0,  0.0,  0.0,  1.0, 11.0, 16.0,
                                                         13.0,  8.0,  0.0,  0.0,  0.0,  0.0,  3.0, 15.0, 16.0, 15.0,  1.0,  0.0,  0.0,
                                                          0.0,  9.0, 11.0,  9.0, 16.0,  3.0,  0.0,  0.0,  0.0,  1.0,  0.0,  3.0, 16.0,
                                                          3.0,  0.0,  0.0,  0.0,  0.0,  0.0,  9.0, 14.0,  0.0,  0.0,  0.0,  0.0,  4.0,
                                                         15.0, 15.0, 16.0,  6.0,  0.0,  0.0,  0.0,  2.0, 12.0, 15.0,  7.0,  1.0,  0.0,
                                                          0.0,  0.0,  0.0, 13.0,  8.0,  0.0,  0.0,  0.0,  0.0,  0.0,  4.0, 14.0,  1.0,
                                                          0.0,  0.0,  0.0,  0.0,  0.0,  5.0, 16.0, 16.0, 10.0,  0.0,  0.0,  0.0,  2.0,
                                                         16.0, 14.0, 14.0, 14.0,  0.0,  0.0,  0.0,  2.0, 14.0,  4.0, 14.0, 10.0,  0.0,
                                                          0.0,  0.0,  0.0,  0.0,  8.0, 16.0,  8.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
                                                          8.0, 16.0,  6.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, 12.0, 13.0,  0.0,  0.0,
                                                          0.0,  7.0, 11.0,  8.0, 16.0, 11.0,  0.0,  0.0,  0.0,  8.0, 16.0, 16.0, 10.0,
                                                          1.0,  0.0,  0.0,  0.0,  6.0, 15.0, 11.0,  0.0,  0.0,  0.0,  0.0,  6.0, 16.0,
                                                         13.0, 16.0,  0.0,  0.0,  0.0,  0.0,  2.0,  7.0, 13.0,  9.0,  0.0,  0.0,  0.0,
                                                          0.0,  0.0,  3.0, 16.0, 15.0,  5.0,  0.0,  0.0,  0.0,  0.0,  0.0,  3.0, 11.0,
                                                         16.0,  2.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, 16.0,  7.0,  0.0,  0.0,  0.0,
                                                         16.0, 11.0, 10.0, 16.0,  7.0,  0.0,  0.0,  0.0,  5.0, 16.0, 15.0,  9.0,  0.0,
                                                          0.0,  0.0,  0.0,  0.0,  8.0, 14.0,  4.0,  0.0,  0.0,  0.0,  0.0,  7.0, 16.0,
                                                          7.0,  0.0,  0.0,  0.0,  0.0,  0.0, 14.0, 10.0,  0.0,  0.0,  0.0,  0.0,  0.0,
                                                          1.0, 16.0,  6.0,  0.0,  0.0,  0.0,  0.0,  0.0,  3.0, 16.0, 16.0, 10.0,  0.0,
                                                          0.0,  0.0,  0.0,  2.0, 16.0, 12.0, 14.0,  6.0,  0.0,  0.0,  0.0,  0.0, 12.0,
                                                         15.0, 11.0, 10.0,  0.0,  0.0,  0.0,  0.0,  0.0, 10.0, 13.0,  8.0,  0.0,  0.0,
                                                          0.0,  0.0,  0.0,  5.0, 12.0, 12.0,  0.0,  0.0,  0.0,  0.0,  5.0, 16.0,  6.0,
                                                          1.0,  0.0,  0.0,  0.0,  0.0, 15.0,  5.0,  0.0,  0.0,  0.0,  0.0,  0.0,  5.0,
                                                         13.0,  2.0,  7.0,  4.0,  0.0,  0.0,  0.0,  7.0, 15.0, 16.0, 13.0, 15.0,  3.0,
                                                          0.0,  0.0,  3.0, 16.0,  9.0,  0.0,  1.0, 12.0,  0.0,  0.0,  0.0, 10.0, 12.0,
                                                          2.0,  6.0, 13.0,  0.0,  0.0,  0.0,  0.0,  8.0, 15.0, 16.0,  5.0,  0.0,  0.0,
                                                          0.0, 10.0, 15.0,  1.0,  0.0,  0.0,  0.0,  0.0,  0.0, 11.0, 16.0,  1.0,  0.0,
                                                          0.0,  0.0,  0.0,  1.0, 16.0, 16.0,  1.0,  0.0,  0.0,  0.0,  0.0,  0.0,  8.0,
                                                         16.0,  5.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, 14.0, 10.0,  0.0,  0.0,  0.0,
                                                          0.0,  0.0,  0.0, 10.0, 14.0,  0.0,  0.0,  0.0,  0.0,  0.0,  5.0, 11.0, 15.0,
                                                          6.0,  4.0,  1.0,  0.0,  0.0, 10.0, 16.0, 16.0, 16.0, 16.0, 10.0});
            input = input.reshape(inputShape);
            var expected = new Tensor<double>(new double[] {9.9967468e-01, 7.1919885e-08, 4.9403676e-11, 1.9290362e-13,
                                                            5.1275326e-09, 1.1534792e-08, 3.2525902e-04, 1.1364481e-11,
                                                            3.0734739e-09, 4.1261217e-08, 1.8529173e-09, 3.3624826e-06,
                                                            2.5770612e-07, 2.9417748e-07, 9.8446189e-06, 2.6676031e-07,
                                                            6.3427780e-07, 3.4315065e-08, 9.9997127e-01, 1.4012296e-05,
                                                            2.9391792e-10, 2.2351846e-06, 7.4365771e-09, 5.2214105e-12,
                                                            2.6014591e-06, 7.7693080e-08, 2.4423953e-08, 6.3235498e-12,
                                                            9.9999511e-01, 8.9036609e-09, 3.5476292e-18, 2.5407303e-18,
                                                            8.3403466e-12, 1.0000000e+00, 5.2364881e-15, 6.4561606e-10,
                                                            2.4608738e-15, 2.6498174e-12, 5.7735383e-10, 3.2373865e-08,
                                                            7.7895130e-09, 1.1693218e-12, 4.5910620e-06, 9.7409323e-02,
                                                            6.1842056e-09, 6.8668231e-07, 9.0258145e-01, 2.8665679e-06,
                                                            1.0763109e-06, 2.0185031e-13, 3.1145495e-10, 5.3304379e-06,
                                                            8.1367849e-05, 4.8317295e-05, 5.5407534e-10, 2.6291472e-08,
                                                            5.3965869e-07, 1.1556048e-06, 9.9986291e-01, 3.8624498e-07,
                                                            9.6391529e-14, 3.6152123e-11, 1.0942138e-19, 8.6044263e-19,
                                                            9.9999988e-01, 2.6465375e-13, 1.2602656e-07, 2.5530164e-10,
                                                            3.0771308e-13, 2.0828361e-22, 2.7999385e-09, 1.8867565e-11,
                                                            9.1214075e-05, 9.9977499e-01, 2.1644152e-11, 3.5637324e-09,
                                                            4.9374790e-08, 2.0889424e-08, 8.6167478e-07, 1.3285663e-04,
                                                            1.7446126e-10, 2.6603371e-11, 3.3232625e-11, 2.3581206e-10,
                                                            2.9605539e-12, 1.0000000e+00, 1.0792480e-13, 4.2305650e-14,
                                                            4.0312000e-11, 5.4370082e-09, 9.3417548e-13, 3.0390246e-10,
                                                            3.2975528e-10, 8.4372445e-08, 1.0108488e-10, 2.1853950e-09,
                                                            2.7887998e-12, 9.9999988e-01, 1.0345131e-09, 9.3687584e-12,
                                                            6.6097724e-16, 6.7721700e-17, 2.6917000e-08, 9.9999988e-01,
                                                            2.2747381e-15, 4.0885073e-08, 2.7721606e-14, 8.3437077e-11,
                                                            1.9827496e-11, 1.0195697e-07, 2.0381178e-14, 4.3376669e-18,
                                                            2.7844794e-11, 9.9999964e-01, 4.5314209e-15, 3.6853976e-07,
                                                            1.7500834e-11, 2.2178369e-13, 2.1527505e-11, 2.7412958e-10,
                                                            1.3614631e-07, 2.9067473e-10, 9.2344286e-15, 3.0912322e-17,
                                                            1.8731997e-05, 3.1451203e-10, 9.9998116e-01, 2.9679719e-16,
                                                            1.0238714e-10, 1.7069964e-18, 8.0768654e-09, 9.7652252e-15,
                                                            2.0869745e-12, 1.6664847e-13, 8.7011998e-09, 4.3702983e-10,
                                                            1.0000000e+00, 4.3121964e-10, 9.2533411e-12, 1.1172841e-15,
                                                            2.2662208e-10, 9.9991763e-01, 3.0647852e-06, 1.3897278e-13,
                                                            2.3456863e-09, 7.7739649e-05, 1.6355366e-07, 8.8741637e-17,
                                                            1.3788482e-06, 4.4387632e-10});
            expected = expected.reshape(batchSize, 10);

            var networkBuilder = new Dense_3Layers();
            var network = networkBuilder.NeuralNetwork;
            var result = network.predict(input);

            Assert.That(result, Is.EqualTo(expected));
        }

        [Test]
        public void NeuralNetwork_MixedLayers_returnsSameResultAsTensorflow()
        {
            int batchSize = 15;
            int[] inputShape = { batchSize, 8, 8, 1 };
            var input = new Tensor<double>(new double[] { 0.00000000e+00, -3.36222892e-01, -3.97347713e-02,  9.83006374e-01,
                                                         -4.36928458e-01, -1.02237368e+00, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -4.31039953e-01,  1.01341442e+00,
                                                          1.19907400e+00, -5.31300528e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01,  7.24825432e-01,  1.21015734e+00,
                                                         -9.86641218e-01,  6.76402883e-01, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01,  9.59004725e-01,  1.93984216e-01,
                                                         -1.62555577e+00, -9.80705574e-02,  4.52675596e-01, -4.97980944e-02,
                                                          0.00000000e+00, -9.87452436e-02,  1.32417342e+00, -3.28753026e-01,
                                                         -1.73211707e+00, -1.16053573e+00,  1.72215214e+00,  0.00000000e+00,
                                                         -6.46814471e-02,  1.28830013e-01,  1.39072553e+00,  1.24363074e-01,
                                                         -1.22594860e+00, -4.01172433e-01,  1.73455394e+00, -9.08172263e-02,
                                                         -3.73560116e-02,  1.43175094e-01,  7.82593799e-01,  8.53268836e-01,
                                                          8.63334964e-01,  1.20496069e+00,  2.56797375e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -3.00046211e-01,  6.60698745e-01,
                                                          8.46706156e-01,  2.04855621e-01, -2.60743232e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01,  8.02902936e-01,  5.14328412e-01,
                                                          5.02896373e-01, -4.93413064e-01, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02,  6.37061244e-01,  4.90906613e-01, -2.78219503e+00,
                                                         -1.31571544e+00,  4.62659697e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -4.41281094e-01,  7.24825432e-01, -1.03489759e+00,
                                                          6.31410353e-01, -1.32578967e-01,  1.28293671e+00, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01,  9.59004725e-01,  7.02092982e-01,
                                                         -1.56194706e-01,  7.51769160e-01,  1.81974250e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.06110889e+00,  7.88375614e-01,
                                                          6.24070060e-01, -1.50282232e+00, -8.25624632e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -2.89880149e-01,  1.05464106e+00,
                                                          6.96804929e-01, -1.45539100e+00, -7.98700917e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01,  7.82593799e-01, -1.63136397e+00,
                                                         -8.33710151e-02, -6.30339515e-01, -7.57470713e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01,  1.07438643e+00, -2.16622539e-02,
                                                          2.37213418e-01, -6.44071951e-01, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00,  7.59890851e-01,  2.06685950e+00,  5.14328412e-01,
                                                         -2.31657812e+00, -1.02237368e+00, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02,  1.26499665e+00,  6.75295926e-01, -3.03523566e+00,
                                                         -2.15397859e+00, -8.62620603e-01,  3.41645789e-02, -1.34055999e-01,
                                                         -4.70485287e-02, -1.60686706e-01,  1.07542152e+00, -6.89504526e-01,
                                                         -8.24836061e-01,  8.38199253e-01,  3.67173618e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01,  3.12807979e-01,  8.71462571e-01,
                                                          8.23379334e-01,  2.41865330e-01, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.06995966e-01,  1.10755523e+00,
                                                          1.19172818e-01, -1.50282232e+00, -8.25624632e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01,  1.23794319e+00,  8.99594726e-01,
                                                          1.01726385e+00, -1.45539100e+00, -7.98700917e-01, -9.08172263e-02,
                                                         -3.73560116e-02,  6.95714775e-01,  1.31192488e+00, -1.05798717e+00,
                                                          1.24201736e+00, -9.64030462e-01, -7.57470713e-01, -2.06950386e-01,
                                                         -2.48759197e-02,  7.57397827e-01,  1.85977651e+00,  8.88152411e-01,
                                                          3.40491717e-02, -9.83642980e-01, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00,  7.59890851e-01,  1.43488122e+00,  9.83006374e-01,
                                                          2.67940165e-01, -6.69733269e-01, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02,  9.51028946e-01,  6.75295926e-01, -1.51699188e+00,
                                                          5.70376641e-01,  6.28319734e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01, -1.72934719e+00, -6.89504526e-01,
                                                          1.27863098e+00, -1.32578967e-01, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01, -1.14113470e+00,  1.21020175e+00,
                                                         -3.19457046e-01, -1.28784616e+00, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.06110889e+00,  4.69196003e-01,
                                                          9.60668221e-01,  3.79753961e-01, -5.42538324e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -1.05379182e+00, -1.11600757e+00,
                                                         -4.24801298e-01,  1.18015542e+00,  8.13370353e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01, -2.76068365e-01, -1.82248957e+00,
                                                         -1.03007699e+00,  8.71269744e-01,  6.62504610e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01,  2.05612403e+00,  8.88152411e-01,
                                                          6.43541910e-01,  2.04855621e-01, -2.60743232e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -1.09303191e+00, -1.88688530e-01,
                                                          3.29839574e-02, -8.46053473e-01, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -4.31039953e-01,  1.01341442e+00,
                                                         -2.67886507e-01, -6.96960566e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01, -1.20345306e+00, -5.16807992e-01,
                                                         -1.14844637e+00, -1.26515356e+00, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -4.63393323e-01, -1.46423307e+00, -1.16097249e+00,
                                                         -3.19457046e-01, -9.47910275e-01, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00,  7.62789247e-01,  1.32417342e+00,  1.10755523e+00,
                                                          9.60668221e-01,  8.93183857e-01, -2.59452015e-01,  0.00000000e+00,
                                                         -6.46814471e-02,  1.28830013e-01,  1.39072553e+00,  2.79409404e-01,
                                                         -7.45260220e-01,  8.28749227e-01,  8.13370353e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01,  6.06150105e-01,  8.53268836e-01,
                                                         -4.62053407e-01,  1.20496069e+00,  1.06821185e+00, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -8.89088771e-01, -4.76569586e-01,
                                                          4.40377664e-01,  5.44426649e-01, -1.56142749e-02, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -1.09303191e+00, -2.06340038e+00,
                                                          5.02896373e-01,  1.26978898e+00,  4.81933379e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -1.90615446e+00,  1.25190170e-03,
                                                         -2.67886507e-01, -3.43204159e-02,  1.69148830e+00, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01, -1.72934719e+00,  8.64764273e-01,
                                                          1.45994882e-01,  5.14606513e-01,  1.28293671e+00, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01, -1.46423307e+00, -3.14124549e-01,
                                                          6.60116994e-01,  5.81801217e-01, -3.59428441e-01, -4.97980944e-02,
                                                          0.00000000e+00, -3.85923407e-01,  5.20228547e-02,  4.69196003e-01,
                                                          7.92369141e-01, -6.47105830e-01, -8.25624632e-01,  0.00000000e+00,
                                                         -6.46814471e-02,  1.44729920e+00,  1.08516086e+00, -1.11600757e+00,
                                                         -5.85030759e-01,  6.53046133e-01, -7.98700917e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01, -9.96246707e-02,  4.71017635e-01,
                                                         -1.59810058e+00,  1.03811522e+00, -3.51763478e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -1.08543629e+00, -2.06874525e+00,
                                                          2.37213418e-01,  1.39335422e+00, -1.56142749e-02, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -1.09303191e+00, -1.12604445e+00,
                                                          7.37852580e-01, -8.46053473e-01, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -1.90615446e+00,  7.60373793e-01,
                                                          1.19907400e+00, -1.19394068e+00, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01, -1.51664789e-01,  1.55555041e+00,
                                                          1.44043614e+00, -9.41560818e-01, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -1.44539279e-01,  1.12055391e+00,  1.21020175e+00,
                                                          9.86641674e-01, -1.28784616e+00, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00,  2.19868006e+00,  1.32417342e+00,  1.10755523e+00,
                                                          9.60668221e-01,  1.23547045e+00,  1.43906583e+00,  0.00000000e+00,
                                                         -6.46814471e-02,  2.10653379e+00,  1.23794319e+00,  1.20968739e+00,
                                                          1.01726385e+00, -4.97662444e-02,  3.52778561e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01, -1.33473053e+00,  2.79892035e-01,
                                                          4.84652573e-01, -1.46456688e+00, -7.57470713e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -1.08543629e+00, -1.38638425e+00,
                                                          6.43541910e-01, -9.83642980e-01, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -8.82372478e-01, -6.57366492e-01,
                                                          9.72808788e-01,  3.55475489e-02, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02,  6.37061244e-01,  6.75295926e-01, -5.04829359e-01,
                                                          1.51245067e-01,  2.96999659e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02,  2.64525718e+00,  2.36332552e-02, -1.20759413e+00,
                                                          9.55020668e-01, -2.94375338e-01, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02,  1.13087690e+00, -3.33388766e-01, -8.22233315e-01,
                                                          9.86641674e-01, -4.38006444e-01, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.22012771e+00, -1.44588167e+00,
                                                         -5.54023504e-01,  5.50897260e-01, -5.42538324e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -1.05379182e+00, -1.11600757e+00,
                                                         -1.22594860e+00, -4.97662444e-02,  1.50425804e+00, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01,  7.68190232e-02,  6.62143236e-01,
                                                         -1.21941819e+00, -1.46456688e+00,  2.08247993e+00,  2.78089581e+00,
                                                         -2.48759197e-02, -3.01126189e-01, -1.08543629e+00, -9.31476919e-01,
                                                          8.46706156e-01,  1.56313974e+00,  2.68080425e+00,  1.43762849e+00,
                                                          0.00000000e+00, -3.36222892e-01,  1.43488122e+00,  4.56504508e-02,
                                                          5.02896373e-01,  1.62242939e+00, -1.13851234e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -3.04841863e-01,  8.59685239e-01, -2.51788729e-01,
                                                         -8.96583867e-01, -5.31300528e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02,  9.61690847e-01,  9.00123477e-01,  8.64764273e-01,
                                                         -5.01225746e-01, -1.26515356e+00, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02,  1.13087690e+00,  3.12807979e-01, -1.44754961e-01,
                                                          4.96854654e-01, -2.68038501e-01, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.22012771e+00, -1.44588167e+00,
                                                         -1.56381799e+00,  7.22040559e-01, -8.25624632e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -1.05379182e+00, -1.11600757e+00,
                                                         -1.22594860e+00,  1.25936850e-01, -1.07813230e-01, -9.08172263e-02,
                                                         -3.73560116e-02,  6.95714775e-01, -2.76068365e-01, -1.63136397e+00,
                                                         -6.51394603e-01,  8.71269744e-01, -1.48909860e-01, -2.06950386e-01,
                                                         -2.48759197e-02,  7.57397827e-01,  1.07438643e+00,  8.88152411e-01,
                                                          2.37213418e-01,  2.04855621e-01, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -4.61053625e-01,  7.48667393e-01,
                                                          9.72808788e-01,  1.62242939e+00, -1.13851234e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -2.46650640e-01, -2.51788729e-01,
                                                         -2.67886507e-01,  1.29095988e+00,  3.10385200e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01, -1.55404914e+00, -1.20759413e+00,
                                                         -6.63030903e-01,  1.32358836e+00,  3.67173618e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01, -1.46423307e+00, -1.49971167e+00,
                                                         -1.56194706e-01,  1.09170505e+00, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -5.84052427e-01,  9.47965420e-01,
                                                          7.92369141e-01,  1.23547045e+00,  8.72893218e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -7.48227152e-01,  7.44548396e-01,
                                                          1.17749331e+00, -2.25469339e-01, -5.68405021e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01, -1.33473053e+00,  6.62143236e-01,
                                                         -2.72712211e-01, -1.46456688e+00, -7.57470713e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -3.00046211e-01,  4.33245079e-01,
                                                         -2.20075753e+00, -1.15342849e+00, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -3.97347713e-02,  9.83006374e-01,
                                                          9.72808788e-01,  7.40828367e-01, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02,  9.12583921e-03,  1.04407455e+00,  5.07333163e-01,
                                                          7.79942427e-01,  9.59639809e-01, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -1.60686706e-01,  7.24825432e-01, -5.16807992e-01,
                                                          1.11682582e+00,  3.52810143e-01, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01, -1.46423307e+00, -1.44754961e-01,
                                                          9.86641674e-01,  7.18973861e-02, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.22012771e+00, -1.44588167e+00,
                                                         -3.85724423e-01,  1.23547045e+00,  8.72893218e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -1.05379182e+00, -1.11600757e+00,
                                                         -1.22594860e+00,  6.53046133e-01,  2.19514573e+00, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01, -9.96246707e-02,  2.79892035e-01,
                                                         -2.72712211e-01,  1.20496069e+00,  1.47391908e+00, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01,  4.85343870e-01,  8.88152411e-01,
                                                          8.46706156e-01,  5.44426649e-01, -2.60743232e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01,  1.70924655e-01,  7.48667393e-01,
                                                         -2.01972250e-01, -1.02237368e+00, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02,  1.26499665e+00,  1.04407455e+00,  2.54292532e-01,
                                                          1.19907400e+00, -1.35960072e+00, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -1.60686706e-01, -5.02260878e-01,  1.03746081e+00,
                                                          3.07800039e-01, -1.26515356e+00, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01, -9.79585512e-01,  1.21020175e+00,
                                                          8.23379334e-01, -4.38006444e-01, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.22012771e+00, -9.67112249e-01,
                                                          1.19172818e-01,  1.23547045e+00, -2.59452015e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -1.05379182e+00, -1.11600757e+00,
                                                         -1.22594860e+00,  1.35585851e+00,  8.13370353e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01,  1.48836857e+00,  2.79892035e-01,
                                                          1.05970181e-01,  1.20496069e+00,  6.62504610e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -1.03698690e-01,  8.88152411e-01,
                                                          6.43541910e-01,  3.74641135e-01, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -1.09303191e+00, -8.91705472e-01,
                                                          5.02896373e-01, -3.17092860e-01, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -6.15429266e-01,  1.01341442e+00,
                                                         -6.87018080e-01, -1.35960072e+00, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01,  7.24825432e-01,  5.19371206e-01,
                                                         -1.14844637e+00, -1.26515356e+00, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -4.63393323e-01,  1.12055391e+00, -4.83494138e-01,
                                                         -1.62555577e+00, -1.28784616e+00, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00,  1.88432920e-01,  1.32417342e+00,  1.10755523e+00,
                                                         -4.91262622e-02, -1.50282232e+00, -8.25624632e-01,  0.00000000e+00,
                                                         -6.46814471e-02,  1.28830013e-01,  1.39072553e+00,  7.44548396e-01,
                                                          1.01726385e+00, -4.01172433e-01, -7.98700917e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01,  7.82593799e-01,  1.04439444e+00,
                                                          2.95311377e-01,  2.03887851e-01, -7.57470713e-01, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -1.08543629e+00, -4.76569586e-01,
                                                          2.37213418e-01,  2.04855621e-01, -5.05872188e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01, -1.09303191e+00, -1.59472241e+00,
                                                          3.29839574e-02,  1.09346878e+00, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01, -9.84207892e-01,  1.01341442e+00,
                                                         -8.96583867e-01, -1.19394068e+00, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -7.21875482e-01,  9.00123477e-01, -3.44111459e-01,
                                                         -1.14844637e+00, -1.26515356e+00, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02,  8.12022852e-01,  6.35906352e-01, -1.16097249e+00,
                                                         -4.82719386e-01, -6.07974388e-01, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00,  1.33714557e+00,  1.16515460e+00,  1.10755523e+00,
                                                          4.55770980e-01,  1.06432716e+00,  2.36342929e-02,  0.00000000e+00,
                                                         -6.46814471e-02,  4.58447310e-01,  1.39072553e+00,  2.79409404e-01,
                                                         -1.22594860e+00, -1.27968790e+00,  1.96484983e+00, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01,  4.29706411e-01,  4.71017635e-01,
                                                         -1.40875939e+00, -4.63494042e-01,  1.87962632e+00, -2.06950386e-01,
                                                         -2.48759197e-02, -3.01126189e-01, -1.08543629e+00, -9.31476919e-01,
                                                          6.43541910e-01,  1.56313974e+00,  7.19772595e-01, -1.94465076e-01,
                                                          0.00000000e+00, -3.36222892e-01,  1.01356236e+00,  7.48667393e-01,
                                                         -2.55153433e+00, -1.02237368e+00, -4.11743540e-01, -1.26301861e-01,
                                                         -6.22910849e-02, -6.18809565e-01,  1.22127987e-01,  1.01341442e+00,
                                                         -1.94441280e+00, -1.35960072e+00, -5.18276662e-01, -1.34055999e-01,
                                                         -4.70485287e-02, -4.41281094e-01,  1.07542152e+00,  1.55555041e+00,
                                                         -9.86641218e-01, -1.26515356e+00, -5.48589477e-01, -1.15612564e-01,
                                                         -3.51907571e-02, -7.82247366e-01, -1.71839580e-01,  1.21020175e+00,
                                                         -8.09244066e-01, -1.28784616e+00, -6.30129787e-01, -4.97980944e-02,
                                                          0.00000000e+00, -6.73101570e-01, -1.22012771e+00,  7.88375614e-01,
                                                         -4.91262622e-02, -1.50282232e+00, -8.25624632e-01,  0.00000000e+00,
                                                         -6.46814471e-02, -5.30404580e-01, -1.05379182e+00,  4.34455735e-01,
                                                          1.01726385e+00, -1.45539100e+00, -7.98700917e-01, -9.08172263e-02,
                                                         -3.73560116e-02, -4.09364588e-01, -4.52512058e-01,  2.79892035e-01,
                                                          1.05267616e+00, -4.63494042e-01,  5.39437573e-02,  7.88998346e-01,
                                                         -2.48759197e-02, -3.01126189e-01,  8.78038911e-01,  8.88152411e-01,
                                                          8.46706156e-01,  1.56313974e+00,  3.41619112e+00,  5.24584682e+00});
            input = input.reshape(inputShape);

            var expected = new Tensor<double>(new double[] {9.4940966e-01, 6.1985105e-05, 1.0837687e-04, 3.4969686e-05,
                                                            1.8875968e-06, 8.1837904e-03, 4.1032434e-02, 1.2885108e-07,
                                                            1.1656441e-03, 1.0069200e-06, 1.5497886e-01, 5.9075478e-02,
                                                            7.1333168e-04, 1.5282030e-04, 1.5919040e-03, 4.1094897e-04,
                                                            8.9287678e-05, 3.6653131e-03, 7.2357380e-01, 5.5748299e-02,
                                                            1.6107433e-03, 7.3699161e-02, 3.9003233e-03, 4.1968950e-05,
                                                            1.8142720e-04, 4.0780945e-04, 5.3636990e-03, 1.3929929e-04,
                                                            9.1437858e-01, 2.7697711e-04, 5.8266079e-07, 7.8815123e-07,
                                                            7.6298806e-04, 9.9879408e-01, 5.7619500e-09, 2.5430607e-04,
                                                            4.3853525e-08, 2.5648509e-05, 8.0541424e-05, 8.1201601e-05,
                                                            6.7867294e-02, 2.6307867e-03, 4.3715592e-03, 1.1502887e-02,
                                                            9.5352822e-04, 1.8656591e-04, 8.9602178e-01, 3.2984808e-05,
                                                            1.6432410e-02, 9.1356895e-08, 5.7965396e-03, 4.5303637e-01,
                                                            3.8914524e-02, 1.3679479e-02, 4.4029257e-03, 6.8528578e-04,
                                                            3.9508071e-04, 2.1321269e-02, 4.2419562e-01, 3.7572883e-02,
                                                            7.5572807e-06, 1.0939360e-05, 7.0631315e-13, 7.9921216e-09,
                                                            9.9986851e-01, 2.2337681e-06, 9.6980744e-05, 1.4665611e-06,
                                                            1.2129260e-05, 2.0209426e-07, 8.7379358e-06, 1.4982208e-03,
                                                            1.9924982e-01, 4.3509477e-01, 3.6708173e-07, 1.1179369e-03,
                                                            6.1014384e-07, 8.0702332e-04, 2.5869962e-02, 3.3635262e-01,
                                                            1.3329498e-03, 3.1872609e-04, 3.9933402e-05, 5.1619471e-03,
                                                            9.3199509e-07, 9.8486024e-01, 1.7323596e-06, 1.0116904e-06,
                                                            5.8300751e-03, 2.4524182e-03, 1.2634770e-09, 1.3487870e-05,
                                                            1.6006597e-05, 6.4972430e-03, 1.4850077e-07, 1.7340054e-07,
                                                            2.5452952e-11, 9.9336785e-01, 6.4341199e-05, 4.0757350e-05,
                                                            1.2183078e-06, 7.7907806e-08, 2.2395721e-04, 9.9143195e-01,
                                                            4.0189072e-10, 1.3239436e-04, 1.1013398e-09, 4.7617145e-06,
                                                            1.3133730e-05, 8.1925737e-03, 2.6027713e-04, 9.0396454e-05,
                                                            4.3072592e-04, 7.0025659e-01, 2.3284499e-06, 2.9445067e-01,
                                                            5.6598874e-05, 1.9968950e-06, 1.7923464e-03, 2.6580705e-03,
                                                            1.2684852e-03, 5.4390216e-03, 4.8942951e-07, 1.4609862e-05,
                                                            7.7345525e-05, 4.6268839e-04, 9.8953992e-01, 5.0575000e-08,
                                                            3.1973566e-03, 2.0246471e-10, 2.2856896e-03, 3.5439420e-04,
                                                            1.2994881e-06, 7.9237507e-05, 2.1508639e-03, 1.3491538e-04,
                                                            9.9431807e-01, 7.0870186e-07, 6.7474321e-04, 7.5124120e-08,
                                                            1.0374482e-07, 9.8268199e-01, 1.0139530e-02, 9.9064373e-06,
                                                            5.7563227e-08, 6.2763109e-05, 3.5033242e-03, 1.7989864e-10,
                                                            3.5754971e-03, 2.6743044e-05});
            expected = expected.reshape(batchSize, 10);

            var networkBuilder = new MixedLayers();
            var network = networkBuilder.NeuralNetwork;
            var result = network.predict(input);

            Assert.That(result, Is.EqualTo(expected));

        }

    }
}
